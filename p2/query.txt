# Нормалізуйте таблицю infectious_cases до 3ї нормальної форми.
# Збережіть у цій же схемі дві таблиці з нормалізованими даними.

CREATE TABLE countries_codes (country_id int auto_increment, Entity VARCHAR(100) NOT NULL, Code VARCHAR(10) NULL, PRIMARY KEY (country_id));
INSERT INTO countries_codes (Entity, Code)
SELECT DISTINCT entity, code FROM infectious_cases ON DUPLICATE KEY UPDATE Entity = VALUES(Entity);

CREATE TABLE maladies (malady_id INT AUTO_INCREMENT PRIMARY KEY, malady_name VARCHAR(100) NOT NULL);
# 1
INSERT INTO maladies (malady_name) VALUES ('Yaws');
# 2
INSERT INTO maladies (malady_name) VALUES ('Polio');
# 3
INSERT INTO maladies (malady_name) VALUES ('Guinea Worm');
# 4
INSERT INTO maladies (malady_name) VALUES ('Rabies');
# 5
INSERT INTO maladies (malady_name) VALUES ('Malaria');
# 6
INSERT INTO maladies (malady_name) VALUES ('HIV');
# 7
INSERT INTO maladies (malady_name) VALUES ('Tuberculosis');
# 8
INSERT INTO maladies (malady_name) VALUES ('Smallpox');
# 9
INSERT INTO maladies (malady_name) VALUES ('Cholera');

CREATE TABLE cases (
    case_id INT AUTO_INCREMENT PRIMARY KEY,
    country_id INT NOT NULL,
    Year INT NOT NULL,
    malady_id INT NOT NULL,
    Number INT NULL,
    FOREIGN KEY (country_id) REFERENCES countries_codes(country_id),
    FOREIGN KEY (malady_id) REFERENCES maladies(malady_id)
);
# 1
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 1 AS malady_id, COALESCE(NULLIF(ic.Number_yaws, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 2
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 2 AS malady_id, COALESCE(NULLIF(ic.polio_cases, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 3
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 3 AS malady_id, COALESCE(NULLIF(ic.cases_guinea_worm, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 4
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 4 AS malady_id, COALESCE(NULLIF(ic.number_rabies, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 5
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 5 AS malady_id, COALESCE(NULLIF(ic.number_malaria, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 6
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 6 AS malady_id, COALESCE(NULLIF(ic.number_hiv, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 7
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 7 AS malady_id, COALESCE(NULLIF(ic.number_tuberculosis, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 8
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 8 AS malady_id, COALESCE(NULLIF(ic.number_smallpox, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;
# 9
INSERT INTO cases (country_id, Year, malady_id, Number)
SELECT c.country_id AS country_id, ic.Year, 9 AS malady_id, COALESCE(NULLIF(ic.number_cholera_cases, ''), null)
FROM infectious_cases ic INNER JOIN countries_codes c ON ic.Entity = c.Entity;